@{
	ViewData["Title"] = ViewBag.SubCategory;
}

<div class="category-page-container">
	@(Html.Kendo().Breadcrumb()
		.Name("breadcrumb")
		.Navigational(true)
		.Items(items =>
		{
			items.Add()
				.Type(BreadcrumbItemType.RootItem)
				.Href("/Home/Index")
				.ShowText(false)
				.Icon("home")
				.ShowIcon(true);
			items.Add()
				.Type(BreadcrumbItemType.Item)
				.Href("/Home/" + ViewBag.Category)
				.Text(ViewBag.Category)
				.ShowText(true);
			items.Add()
				.Type(BreadcrumbItemType.Item)
				.Href(@Url.Action("Category", "Products", new { subCategory = ViewBag.SubCategory }))
				.Text(ViewBag.SubCategory)
				.ShowText(true);
		})
	)

	<div class="category-content-container">
		@await Html.PartialAsync("_MainControls.cshtml")
		@await Html.PartialAsync("_AllProductsListView.cshtml")
	</div>
</div>

<script type="text/html" id="product-template">
	@await Html.PartialAsync("_TileProductCard.cshtml")	
</script>

<span hidden id="subCategory">@ViewBag.SubCategory</span>

<script>
	$(document).ready(function () {
		var searchParam = '@ViewBag.SearchParam';
		if (searchParam != null) {
			$("#searchBar").data("kendoAutoComplete").value(searchParam);
		}

		$.get("/Products/GetAllModelsInSubCategory?subCategory=@ViewBag.SubCategory", function (data) {
			if (data.length == 0) {
				$("#modelPicker").parent().hide();
			}
			else {
				$("#modelPicker").kendoCheckBoxGroup({
					items: data,
					change: function (e) { filterDataSource(); }
				});
			}
		});

		$.get("/Products/GetAllSizesInSubCategory?subCategory=@ViewBag.SubCategory", function (data) {
			if(data.length == 0) {
				$("#sizePicker").parent().hide();
			}
			else {
				$("#sizePicker").kendoCheckBoxGroup({
					items: data,
					change: function (e) { filterDataSource(); }
				});
			}			
		});

		$.get("/Products/GetAllColorsInSubCategory?subCategory=@ViewBag.SubCategory", function (data) {
			if (data.length == 0) {
				$("#colorPicker").parent().hide();
			}
			else {
				$("#colorPicker").kendoCheckBoxGroup({
					items: data,
					change: function (e) { filterDataSource(); }
				});
			}			
		});
	});
</script>

<style>
	#breadcrumb {
		margin-left: 30px;
	}

	.category-page-container {
		margin-top: 35px;
		margin: auto;
		width: 1500px;
	}

	.category-content-container {
		display: flex;
		flex-direction: row;
	}
</style>